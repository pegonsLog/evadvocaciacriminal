<!-- Loading State -->
<div class="client-details-container" *ngIf="!cliente">
  <div class="container">
    <div class="empty-state">
      <div class="empty-state-content">
        <div class="empty-state-icon">
          <i class="bi bi-hourglass-split"></i>
        </div>
        <h3>Carregando dados do cliente...</h3>
        <p>Aguarde enquanto buscamos as informações</p>
      </div>
    </div>
  </div>
</div>

<div class="client-details-container" *ngIf="cliente">
  <!-- Header Section -->
  <div class="header-section">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-lg-8">
          <div class="client-header-info">
            <div class="client-avatar-large">
              <i class="bi bi-person-circle"></i>
            </div>
            <div class="client-title-info">
              <h1 class="client-title">{{ cliente.nome }}</h1>
              <p class="client-subtitle">Cliente desde {{ cliente.dataCadastro | date:'dd/MM/yyyy' }}</p>
            </div>
          </div>
        </div>
        <div class="col-lg-4 text-lg-end">
          <div class="header-actions">
            <button class="btn btn-outline-light me-2" (click)="voltar()">
              <i class="bi bi-arrow-left me-2"></i>
              Voltar
            </button>
            <button class="btn btn-light" (click)="editar()">
              <i class="bi bi-pencil me-2"></i>
              Editar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container mt-4">

    <!-- Quick Stats -->
    <div class="quick-stats mb-5">
      <div class="row g-4">
        <div class="col-md-4">
          <div class="stat-card success">
            <div class="stat-icon">
              <i class="bi bi-check-circle"></i>
            </div>
            <div class="stat-content">
              <h3>{{ totalPago | currency:'BRL':'symbol':'1.0-0':'pt-BR' }}</h3>
              <p>Total Pago</p>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="stat-card warning">
            <div class="stat-icon">
              <i class="bi bi-clock-history"></i>
            </div>
            <div class="stat-content">
              <h3>{{ saldoDevedor | currency:'BRL':'symbol':'1.0-0':'pt-BR' }}</h3>
              <p>Saldo Devedor</p>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="stat-card info">
            <div class="stat-icon">
              <i class="bi bi-list-check"></i>
            </div>
            <div class="stat-content">
              <h3>{{ parcelasPagas }}/{{ cliente.contrato.numeroParcelas }}</h3>
              <p>Parcelas Pagas</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row g-4">
      <!-- Personal Information -->
      <div class="col-lg-6">
        <div class="info-card">
          <div class="info-card-header">
            <div class="info-icon personal">
              <i class="bi bi-person"></i>
            </div>
            <h4>Informações Pessoais</h4>
          </div>
          <div class="info-card-body">
            <div class="info-item">
              <div class="info-label">
                <i class="bi bi-person-badge"></i>
                Nome Completo
              </div>
              <div class="info-value">{{ cliente.nome }}</div>
            </div>
            <div class="info-item">
              <div class="info-label">
                <i class="bi bi-card-text"></i>
                CPF
              </div>
              <div class="info-value">{{ cliente.cpf }}</div>
            </div>
            <div class="info-item">
              <div class="info-label">
                <i class="bi bi-telephone"></i>
                Telefone
              </div>
              <div class="info-value">{{ cliente.telefone }}</div>
            </div>
            <div class="info-item">
              <div class="info-label">
                <i class="bi bi-envelope"></i>
                E-mail
              </div>
              <div class="info-value">{{ cliente.email }}</div>
            </div>
            <div class="info-item">
              <div class="info-label">
                <i class="bi bi-geo-alt"></i>
                Endereço
              </div>
              <div class="info-value">{{ cliente.endereco }}</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Purchase Information -->
      <div class="col-lg-6">
        <div class="info-card">
          <div class="info-card-header">
            <div class="info-icon purchase">
              <i class="bi bi-file-earmark-text"></i>
            </div>
            <h4>Informações do Contrato</h4>
          </div>
          <div class="info-card-body">
            <div class="info-item">
              <div class="info-label">
                <i class="bi bi-file-text"></i>
                Número do Contrato
              </div>
              <div class="info-value">{{ cliente.contrato.numeroContrato || 'Não informado' }}</div>
            </div>
            <div class="info-item">
              <div class="info-label">
                <i class="bi bi-currency-dollar"></i>
                Valor Total
              </div>
              <div class="info-value highlight">{{ (cliente.contrato.valorTotal || 0) |
                currency:'BRL':'symbol':'1.2-2':'pt-BR'
                }}</div>
            </div>
            <div class="info-item">
              <div class="info-label">
                <i class="bi bi-cash-coin"></i>
                Valor da Entrada
              </div>
              <div class="info-value">{{ (cliente.contrato.valorEntrada || 0) | currency:'BRL':'symbol':'1.2-2':'pt-BR'
                }}
              </div>
            </div>
            <div class="info-item">
              <div class="info-label">
                <i class="bi bi-list-ol"></i>
                Parcelas
              </div>
              <div class="info-value">{{ cliente.contrato.numeroParcelas || 0 }}x de {{ (cliente.contrato.valorParcela
                || 0) |
                currency:'BRL':'symbol':'1.2-2':'pt-BR' }}</div>
            </div>
            <div class="info-item">
              <div class="info-label">
                <i class="bi bi-calendar-event"></i>
                Vencimento
              </div>
              <div class="info-value">Todo dia {{ getDiaVencimento() }}</div>
            </div>
            <div class="info-item">
              <div class="info-label">
                <i class="bi bi-calendar3"></i>
                Data do Contrato
              </div>
              <div class="info-value">{{ formatarDataContrato() }}</div>
            </div>
            <div class="info-item" *ngIf="cliente.contrato.dataPrimeiroVencimento">
              <div class="info-label">
                <i class="bi bi-calendar-date"></i>
                Primeiro Vencimento
              </div>
              <div class="info-value">{{ formatarDataPrimeiroVencimento() }}</div>
            </div>

          </div>
        </div>
      </div>
    </div>

    <!-- Payment Management Section -->
    <div class="payment-management-section mt-5">
      <div class="payment-card">
        <div class="payment-card-header">
          <div class="payment-header-content">
            <div class="payment-icon">
              <i class="bi bi-cash-stack"></i>
            </div>
            <div class="payment-title">
              <h4>Gerenciamento de Pagamentos</h4>
              <p>Controle completo das parcelas e pagamentos</p>
            </div>
          </div>
          <button class="btn btn-primary btn-lg" (click)="verPagamentos()">
            <i class="bi bi-gear me-2"></i>
            Gerenciar Pagamentos
          </button>
        </div>

        <div class="payment-card-body">
          <div class="progress-section">
            <div class="progress-info">
              <span>Progresso dos Pagamentos</span>
              <span>{{ parcelasPagas }}/{{ cliente.contrato.numeroParcelas }} parcelas</span>
            </div>
            <div class="progress">
              <div class="progress-bar" [style.width.%]="(parcelasPagas / cliente.contrato.numeroParcelas) * 100">
              </div>
            </div>
            <div class="progress-percentage">
              {{ ((parcelasPagas / cliente.contrato.numeroParcelas) * 100) | number:'1.0-0' }}% concluído
            </div>
          </div>

          <div class="payment-info-grid">
            <div class="payment-info-item">
              <i class="bi bi-calendar-check text-success"></i>
              <div>
                <strong>Próximo Vencimento</strong>
                <p>Dia {{ getDiaVencimento() }} do mês</p>
              </div>
            </div>
            <div class="payment-info-item">
              <i class="bi bi-cash text-primary"></i>
              <div>
                <strong>Valor da Parcela</strong>
                <p>{{ cliente.contrato.valorParcela | currency:'BRL':'symbol':'1.2-2':'pt-BR' }}</p>
              </div>
            </div>
            <div class="payment-info-item">
              <i class="bi bi-graph-up text-info"></i>
              <div>
                <strong>Status do Contrato</strong>
                <p>{{ parcelasPagas === cliente.contrato.numeroParcelas ? 'Quitado' : 'Em andamento' }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Additional Notes -->
    <div class="notes-section mt-4" *ngIf="cliente.contrato.relatorioContratosPendentes">
      <div class="notes-card">
        <div class="notes-header">
          <i class="bi bi-file-text me-2"></i>
          Observações do Contrato
        </div>
        <div class="notes-content">
          {{ cliente.contrato.relatorioContratosPendentes }}
        </div>
      </div>
    </div>
  </div>
</div>

<div class="client-details-container" *ngIf="!cliente">
  <div class="container">
    <div class="empty-state">
      <div class="empty-state-content">
        <div class="empty-state-icon error">
          <i class="bi bi-exclamation-triangle"></i>
        </div>
        <h3>Cliente não encontrado</h3>
        <p>O cliente solicitado não existe ou foi removido do sistema</p>
        <button class="btn btn-primary btn-lg" (click)="voltar()">
          <i class="bi bi-arrow-left me-2"></i>
          Voltar para Lista
        </button>
      </div>
    </div>
  </div>
</div>

<div class="dashboard-container">
  <!-- Welcome Section -->
  <div class="welcome-section">
    <div class="container">
      <div class="welcome-content">
        <div class="welcome-text">
          <h1 class="welcome-title">
            <i class="bi bi-house-heart me-3"></i>
            Dashboard
          </h1>
          <p class="welcome-subtitle">Bem-vindo ao painel de controle do sistema</p>
        </div>
        <div class="welcome-actions">
          <button class="btn btn-welcome" (click)="novoCliente()">
            <i class="bi bi-person-plus me-2"></i>
            Novo Cliente
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Dashboard Stats -->
  <div class="dashboard-stats" *ngIf="clientes.length > 0">
    <div class="container">
      <div class="stats-grid">
        <div class="stat-card clients">
          <div class="stat-header">
            <div class="stat-icon">
              <i class="bi bi-people"></i>
            </div>
            <div class="stat-trend up">
              <i class="bi bi-arrow-up"></i>
            </div>
          </div>
          <div class="stat-body">
            <h3 class="stat-number">{{ clientes.length }}</h3>
            <p class="stat-label">Clientes Ativos</p>
            <span class="stat-description">Total cadastrado</span>
          </div>
        </div>

        <div class="stat-card revenue">
          <div class="stat-header">
            <div class="stat-icon">
              <i class="bi bi-currency-dollar"></i>
            </div>
            <div class="stat-trend up">
              <i class="bi bi-arrow-up"></i>
            </div>
          </div>
          <div class="stat-body">
            <h3 class="stat-number">{{ getTotalRecebido() | currency:'BRL':'symbol':'1.0-0':'pt-BR' }}</h3>
            <p class="stat-label">Total Recebido</p>
            <span class="stat-description">Pagamentos confirmados</span>
          </div>
        </div>

        <div class="stat-card pending">
          <div class="stat-header">
            <div class="stat-icon">
              <i class="bi bi-hourglass-split"></i>
            </div>
            <div class="stat-trend neutral">
              <i class="bi bi-dash"></i>
            </div>
          </div>
          <div class="stat-body">
            <h3 class="stat-number">{{ getTotalPendente() | currency:'BRL':'symbol':'1.0-0':'pt-BR' }}</h3>
            <p class="stat-label">Valor Pendente</p>
            <span class="stat-description">Aguardando pagamento</span>
          </div>
        </div>

        <div class="stat-card performance">
          <div class="stat-header">
            <div class="stat-icon">
              <i class="bi bi-graph-up-arrow"></i>
            </div>
            <div class="stat-trend" [class]="getPercentualRecebido() >= 70 ? 'up' : 'down'">
              <i class="bi" [class]="getPercentualRecebido() >= 70 ? 'bi-arrow-up' : 'bi-arrow-down'"></i>
            </div>
          </div>
          <div class="stat-body">
            <h3 class="stat-number">{{ getPercentualRecebido() }}%</h3>
            <p class="stat-label">Taxa de Recebimento</p>
            <span class="stat-description">Performance geral</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <!-- Quick Actions & Search -->
    <div class="dashboard-actions" *ngIf="clientes.length > 0">
      <div class="actions-header">
        <h4>
          <i class="bi bi-lightning me-2"></i>
          Ações Rápidas
        </h4>
      </div>
      
      <div class="actions-content">
        <div class="quick-search">
          <div class="search-box">
            <i class="bi bi-search"></i>
            <input 
              type="text" 
              placeholder="Buscar cliente rapidamente..."
              [(ngModel)]="filtroNome"
              (ngModelChange)="aplicarFiltro()">
            <button 
              class="clear-btn" 
              *ngIf="filtroNome"
              (click)="filtroNome = ''; aplicarFiltro()">
              <i class="bi bi-x"></i>
            </button>
          </div>
          <div class="search-info" *ngIf="clientesFiltrados.length !== clientes.length">
            {{ clientesFiltrados.length }} de {{ clientes.length }} clientes
          </div>
        </div>

        <div class="quick-buttons">
          <button class="quick-btn" routerLink="/clientes">
            <i class="bi bi-list-ul"></i>
            <span>Ver Todos</span>
          </button>
          <button class="quick-btn" routerLink="/controle-pagamentos">
            <i class="bi bi-graph-up"></i>
            <span>Relatórios</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Empty States -->
    <div *ngIf="clientes.length === 0" class="welcome-empty-state">
      <div class="empty-content">
        <div class="empty-illustration">
          <i class="bi bi-person-plus-fill"></i>
        </div>
        <h3>Comece sua jornada</h3>
        <p>Cadastre seu primeiro cliente e comece a gerenciar contratos e pagamentos de forma eficiente</p>
        <div class="empty-actions">
          <button class="btn btn-primary btn-lg" (click)="novoCliente()">
            <i class="bi bi-plus-circle me-2"></i>
            Cadastrar Primeiro Cliente
          </button>
        </div>
        <div class="empty-features">
          <div class="feature-item">
            <i class="bi bi-check-circle"></i>
            <span>Controle de pagamentos</span>
          </div>
          <div class="feature-item">
            <i class="bi bi-check-circle"></i>
            <span>Relatórios detalhados</span>
          </div>
          <div class="feature-item">
            <i class="bi bi-check-circle"></i>
            <span>Gestão de contratos</span>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="clientes.length > 0 && clientesFiltrados.length === 0" class="search-empty-state">
      <div class="search-empty-content">
        <div class="search-empty-icon">
          <i class="bi bi-search"></i>
        </div>
        <h4>Nenhum resultado encontrado</h4>
        <p>Não encontramos clientes com o termo "{{ filtroNome }}"</p>
        <button class="btn btn-outline-secondary" (click)="filtroNome = ''; aplicarFiltro()">
          <i class="bi bi-arrow-clockwise me-2"></i>
          Limpar Busca
        </button>
      </div>
    </div>

    <!-- Recent Clients -->
    <div class="recent-clients" *ngIf="clientesFiltrados.length > 0">
      <div class="section-header">
        <h4>
          <i class="bi bi-clock-history me-2"></i>
          {{ filtroNome ? 'Resultados da Busca' : 'Clientes Recentes' }}
        </h4>
        <a routerLink="/clientes" class="view-all-link">
          Ver todos
          <i class="bi bi-arrow-right ms-1"></i>
        </a>
      </div>

      <div class="clients-preview">
        <div class="row g-3">
          <div class="col-lg-6" *ngFor="let cliente of clientesFiltrados.slice(0, 6); trackBy: trackByClienteId">
            <div class="client-preview-card" (click)="verDetalhes(cliente.id)">
              <div class="client-preview-header">
                <div class="client-avatar-small">
                  {{ cliente.nome.charAt(0).toUpperCase() }}
                </div>
                <div class="client-basic-info">
                  <h6 class="client-name">{{ cliente.nome }}</h6>
                  <span class="client-contract">Contrato {{ cliente.compra.numeroContrato }}</span>
                </div>
                <div class="client-status-indicator" [class]="getStatusClass(cliente.id)">
                  <i class="bi" [class]="getStatusIcon(cliente.id)"></i>
                </div>
              </div>

              <div class="client-preview-body">
                <div class="client-metrics">
                  <div class="metric">
                    <span class="metric-label">Total</span>
                    <span class="metric-value">{{ cliente.compra.valorTotal | currency:'BRL':'symbol':'1.0-0':'pt-BR' }}</span>
                  </div>
                  <div class="metric" *ngIf="getResumo(cliente.id) as resumo">
                    <span class="metric-label">Pago</span>
                    <span class="metric-value paid">{{ resumo.totalPago | currency:'BRL':'symbol':'1.0-0':'pt-BR' }}</span>
                  </div>
                  <div class="metric" *ngIf="getResumo(cliente.id) as resumo">
                    <span class="metric-label">Pendente</span>
                    <span class="metric-value pending">{{ resumo.saldoDevedor | currency:'BRL':'symbol':'1.0-0':'pt-BR' }}</span>
                  </div>
                </div>

                <div class="progress-mini" *ngIf="getResumo(cliente.id) as resumo">
                  <div class="progress-bar-mini" 
                       [style.width.%]="(resumo.parcelasPagas / cliente.compra.numeroParcelas) * 100">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="show-more" *ngIf="clientesFiltrados.length > 6">
          <button class="btn btn-outline-secondary" routerLink="/clientes">
            <i class="bi bi-plus me-2"></i>
            Ver mais {{ clientesFiltrados.length - 6 }} cliente(s)
          </button>
        </div>
      </div>
    </div>
  </div>
</div>